================================================================================
ДОКУМЕНТАЦИЯ ЗА ПРОЕКТ ПО УЕБ ТЕХНОЛОГИИ
================================================================================

Имена:  ...                                         фн:  ...
Начална година: 2016        Програма:  бакалавър, (СИ)    Курс:   4  
Тема:  Визуализация и навигация в университетски кампус
Дата:  2026-01-30           Предмет: w25prj_KN _final     имейл: ...
Преподавател: доц. д-р Милен Петров

================================================================================
1. УСЛОВИЕ
================================================================================

Разработване на уеб приложение за визуализация на университетски кампус върху 
карта (OpenStreetMap) с функционалност за намиране на най-кратък път между 
учебни зали и сгради. Системата използва трислойна архитектура с MySQL база 
данни за съхранение на данни за локации и потребители.

Основни изисквания:
- Визуализация на сгради/зали върху интерактивна карта (OpenStreetMap)
- Представяне на кампуса като граф структура
- Алгоритъм за намиране на оптимален маршрут между локации (Dijkstra)
- Импорт и експорт на данни в JSON/CSV формат
- Съхранение на данни в MySQL база данни
- Система за регистрация и автентикация на потребители
- CRUD операции за управление на зали и връзки

================================================================================
2. ВЪВЕДЕНИЕ - ИЗВЛИЧАНЕ НА ИЗИСКВАНИЯ
================================================================================

2.1 Роли:
- Гост - преглед на картата, търсене на маршрут (без регистрация)
- Потребител - регистриран потребител с достъп до системата

2.2 Функционални изисквания:
- Визуализация на интерактивна карта с маркери за всяка зала/сграда
- Падащо меню за избор на начална и крайна точка
- Изчисляване на най-кратък път между две локации чрез алгоритъм на Dijkstra
- Визуално показване на изчисления път върху картата
- Експорт на данни в JSON формат
- Експорт на данни в CSV формат
- Импорт на данни от JSON файл
- Показване на разстояние в минути за изчисления маршрут
- Регистрация на нови потребители
- Вход в системата с потребителско име/email и парола
- Изход от системата
- Добавяне на нови зали в базата данни (INSERT)
- Редактиране на съществуващи зали (UPDATE)
- Изтриване на зали (DELETE)
- Преглед на всички зали (SELECT)
- Добавяне/изтриване на връзки между зали

2.3 Нефункционални изисквания:
- Трислойна архитектура (презентация, бизнес логика, данни)
- Конфигурируемост чрез единен конфигурационен файл
- Защита срещу SQL injection чрез PDO prepared statements
- Сигурно съхранение на пароли чрез password_hash()
- Лесна употреба и интуитивен интерфейс
- Бързо зареждане и отзивчивост

2.4 Ползи от реализацията:
- Лесна навигация в големи университетски кампуси
- Оптимизиране на време между занятия
- Визуална представа за разположението на учебните зали
- Централизирано съхранение на данни в база данни

================================================================================
3. ТЕОРИЯ - АНАЛИЗ И ПРОЕКТИРАНЕ НА РЕШЕНИЕТО
================================================================================

3.1 Архитектура на системата:

Трислойна архитектура:

+--------------------------------------------------+
|           ПРЕЗЕНТАЦИОНЕН СЛОЙ                    |
|  HTML, CSS, JavaScript, Leaflet                  |
|  index.html, login.php, register.php             |
+--------------------------------------------------+
                      |
                      v
+--------------------------------------------------+
|           БИЗНЕС ЛОГИКА (PHP)                    |
|  api.php - CRUD операции                         |
|  auth.php - автентикация                         |
|  db.php - абстракция на базата данни             |
+--------------------------------------------------+
                      |
                      v
+--------------------------------------------------+
|           СЛОЙ ЗА ДАННИ (MySQL)                  |
|  Таблици: users, nodes, edges                    |
+--------------------------------------------------+

3.2 Структура на базата данни:

Таблица users:
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- username (VARCHAR 50, UNIQUE)
- email (VARCHAR 100, UNIQUE)
- password_hash (VARCHAR 255)
- created_at (DATETIME)
- last_login (DATETIME)

Таблица nodes:
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- name (VARCHAR 100)
- lat (DECIMAL 10,7) - географска ширина
- lng (DECIMAL 10,7) - географска дължина
- floor (INT) - етаж
- building (VARCHAR 100) - сграда
- created_at (DATETIME)

Таблица edges:
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- node_from (INT, FOREIGN KEY -> nodes.id)
- node_to (INT, FOREIGN KEY -> nodes.id)
- weight (INT) - време в минути
- created_at (DATETIME)

3.3 Декомпозиция на модулите:

а) Презентационен слой:
   - index.html - главна страница с карта и навигация
   - login.php - страница за вход
   - register.php - страница за регистрация
   - css/style.css - основни стилове
   - css/auth.css - стилове за форми за вход/регистрация

б) JavaScript модули:
   - js/graph.js - граф структура и алгоритъм на Dijkstra
   - js/map.js - работа с Leaflet и OpenStreetMap
   - js/app.js - основна логика на приложението

в) PHP модули:
   - php/config.php - конфигурационни настройки
   - php/db.php - функции за работа с базата данни
   - php/api.php - REST API за CRUD операции
   - php/auth.php - автентикация (login, register, logout)

г) SQL скриптове:
   - sql/database.sql - създаване на таблици и примерни данни

3.4 Алгоритъм на Dijkstra:

Използван е класически алгоритъм на Dijkstra за намиране на най-кратък път.
Алгоритъмът работи с тегловен граф, където тежестите са време в минути.

Сложност: O((V + E) log V)

================================================================================
4. ИЗПОЛЗВАНИ ТЕХНОЛОГИИ
================================================================================

4.1 Сървърна страна:
- PHP 7.4+ (тествано с PHP 8.x)
- MySQL 5.7+ / MariaDB 10.x
- XAMPP (Apache + MySQL + PHP)

4.2 Клиентска страна:
- HTML5
- CSS3
- JavaScript (ES6)
- Leaflet 1.9.4 (библиотека за карти)

4.3 Карти:
- OpenStreetMap (безплатни картографски данни)
- Leaflet (JavaScript библиотека)

4.4 Среда за разработка:
- Visual Studio Code
- XAMPP Control Panel
- phpMyAdmin (за управление на MySQL)

4.5 Операционна система:
- Windows 10/11 (разработка)
- Съвместимо с Linux/macOS

================================================================================
5. ИНСТАЛАЦИЯ, НАСТРОЙКИ И DEVOPS
================================================================================

5.1 Изисквания:
- XAMPP (или еквивалент с Apache, PHP, MySQL)
- Уеб браузър с поддръжка на JavaScript
- Интернет връзка (за Leaflet и OpenStreetMap)

5.2 Стъпки за инсталация:

Стъпка 1: Инсталиране на XAMPP
- Изтеглете от https://www.apachefriends.org/
- Инсталирайте с опции Apache и MySQL

Стъпка 2: Копиране на проекта
- Копирайте папката ProjectWeb в C:\xampp\htdocs\

Стъпка 3: Създаване на база данни
- Стартирайте XAMPP Control Panel
- Стартирайте Apache и MySQL
- Отворете http://localhost/phpmyadmin
- Импортирайте sql/database.sql

Стъпка 4: Конфигурация
- Отворете php/config.php
- Проверете настройките за база данни:
  define('DB_HOST', 'localhost');
  define('DB_NAME', 'campus_navigator');
  define('DB_USER', 'root');
  define('DB_PASS', '');

Стъпка 5: Стартиране
- Отворете http://localhost/ProjectWeb/

5.3 Структура на файловете:

ProjectWeb/
├── index.html              - главна страница с карта
├── login.php              - страница за вход
├── register.php           - страница за регистрация
├── css/
│   ├── style.css          - основни стилове
│   └── auth.css           - стилове за вход/регистрация
├── js/
│   ├── graph.js           - граф и Dijkstra
│   ├── map.js             - Leaflet карта
│   └── app.js             - приложна логика
├── php/
│   ├── config.php         - конфигурация
│   ├── db.php             - функции за БД
│   ├── api.php            - REST API
│   └── auth.php           - автентикация
├── sql/
│   └── database.sql       - SQL скрипт
└── data/
    └── campus.json        - примерни данни

5.4 Примерни акаунти:

Администратор:
- Потребител: admin
- Парола: admin123

Обикновен потребител:
- Потребител: user
- Парола: user123

5.5 Конфигурационен файл (php/config.php):

// Настройки на базата данни
define('DB_HOST', 'localhost');
define('DB_NAME', 'campus_navigator');
define('DB_USER', 'root');
define('DB_PASS', '');

// URL на сайта
define('SITE_URL', 'http://localhost/ProjectWeb');

================================================================================
6. КРАТКО РЪКОВОДСТВО НА ПОТРЕБИТЕЛЯ
================================================================================

6.1 Регистрация:
1. Отворете register.php
2. Въведете потребителско име (минимум 3 символа)
3. Въведете валиден email адрес
4. Въведете парола (минимум 6 символа)
5. Повторете паролата
6. Натиснете бутона "Регистрация"

6.2 Вход в системата:
1. Отворете login.php
2. Въведете потребителско име или email
3. Въведете парола
4. Натиснете бутона "Вход"

6.3 Преглед на картата:
- При зареждане се показва интерактивна карта
- Картата може да се движи с мишка
- Zoom с колелцето на мишката или бутоните +/-
- Кликнете върху маркер за информация за залата

6.4 Намиране на маршрут:
1. Изберете начална точка от падащото меню
2. Изберете крайна точка от падащото меню
3. Натиснете "Намери път"
4. Резултатът показва маршрута и времето
5. На картата се визуализира пътят

6.5 Експорт на данни:
- "Експорт JSON" - запазва всички данни като JSON файл
- "Експорт CSV" - запазва данните като CSV файлове

6.6 Импорт на данни:
1. Изберете JSON файл чрез бутона за файл
2. Натиснете "Импорт"
3. Данните се зареждат в системата

================================================================================
7. ПРИМЕРНИ ДАННИ
================================================================================

7.1 Примерни локации (таблица nodes):

ID  Име                      Latitude    Longitude   Етаж  Сграда
--  ----------------------   ----------  ----------  ----  ----------
1   Зала 101 - Лекционна     42.6940000  23.3340000  1     Корпус А
2   Зала 102 - Компютърна    42.6938000  23.3355000  1     Корпус А
3   Зала 201 - Семинарна     42.6930000  23.3345000  2     Корпус А
4   Библиотека               42.6925000  23.3360000  1     Корпус Б
5   Кафене/Стол              42.6935000  23.3330000  0     Централно

7.2 Примерни връзки (таблица edges):

ID  От  До  Време(мин)
--  --  --  ----------
1   1   2   3
2   1   3   2
3   1   5   4
4   2   4   5
5   3   4   4
6   4   5   6
7   2   3   3

7.3 Примерни потребители (таблица users):

ID  Потребител  Email             Парола
--  ----------  ----------------  --------
1   admin       admin@campus.bg   admin123
2   user        user@campus.bg    user123

7.4 Тестови сценарии:

Сценарий 1: Регистрация на нов потребител
- Въведете: testuser, test@test.bg, test123
- Очакван резултат: Успешна регистрация

Сценарий 2: Вход с грешна парола
- Въведете: admin, wrongpass
- Очакван резултат: Грешка "Грешно потребителско име или парола"

Сценарий 3: Намиране на път от Зала 101 до Библиотека
- Избор: Зала 101 -> Библиотека
- Очакван резултат: 101 -> 201 -> Библиотека (6 минути)

7.5 SQL файл за тестване:
- sql/database.sql - съдържа CREATE TABLE и INSERT за всички данни

================================================================================
8. ОПИСАНИЕ НА ПРОГРАМНИЯ КОД
================================================================================

8.1 Файл: php/config.php

Цел: Централизирани настройки на приложението

Код (фрагмент 1):
// Настройки на базата данни
define('DB_HOST', 'localhost');
define('DB_NAME', 'campus_navigator');
define('DB_USER', 'root');
define('DB_PASS', '');

8.2 Файл: php/db.php

Цел: Абстракция за работа с MySQL чрез PDO

Код (фрагмент 2 - Връзка с базата):
function getDBConnection() {
    static $pdo = null;
    if ($pdo === null) {
        $dsn = "mysql:host=" . DB_HOST . ";dbname=" . DB_NAME;
        $pdo = new PDO($dsn, DB_USER, DB_PASS, $options);
    }
    return $pdo;
}

Код (фрагмент 3 - INSERT функция):
function dbInsert($sql, $params = []) {
    $pdo = getDBConnection();
    $stmt = $pdo->prepare($sql);
    $stmt->execute($params);
    return $pdo->lastInsertId();
}

Код (фрагмент 4 - DELETE функция):
function dbDelete($sql, $params = []) {
    $pdo = getDBConnection();
    $stmt = $pdo->prepare($sql);
    $stmt->execute($params);
    return $stmt->rowCount();
}

8.3 Файл: php/api.php

Цел: REST API за CRUD операции със зали

Код (фрагмент 5 - SELECT всички зали):
case 'get_nodes':
    $nodes = dbSelect("SELECT * FROM nodes ORDER BY name");
    echo json_encode(['success' => true, 'data' => $nodes]);
    break;

Код (фрагмент 6 - INSERT нова зала):
case 'add_node':
    $sql = "INSERT INTO nodes (name, lat, lng, floor, building) 
            VALUES (?, ?, ?, ?, ?)";
    $id = dbInsert($sql, [$name, $lat, $lng, $floor, $building]);
    echo json_encode(['success' => true, 'id' => $id]);
    break;

Код (фрагмент 7 - UPDATE зала):
case 'update_node':
    $sql = "UPDATE nodes SET name=?, lat=?, lng=?, floor=?, building=? 
            WHERE id=?";
    $affected = dbUpdate($sql, [$name, $lat, $lng, $floor, $building, $id]);
    break;

Код (фрагмент 8 - DELETE зала):
case 'delete_node':
    dbDelete("DELETE FROM edges WHERE node_from=? OR node_to=?", [$id, $id]);
    dbDelete("DELETE FROM nodes WHERE id = ?", [$id]);
    break;

8.4 Файл: php/auth.php

Цел: Функции за регистрация и вход

Код (фрагмент 9 - Регистрация):
function registerUser($username, $email, $password) {
    $passwordHash = password_hash($password, PASSWORD_DEFAULT);
    $sql = "INSERT INTO users (username, email, password_hash, created_at) 
            VALUES (?, ?, ?, NOW())";
    $userId = dbInsert($sql, [$username, $email, $passwordHash]);
    return ['success' => true, 'user_id' => $userId];
}

Код (фрагмент 10 - Вход):
function loginUser($username, $password) {
    $user = dbSelectOne(
        "SELECT * FROM users WHERE username = ? OR email = ?",
        [$username, $username]
    );
    if (!password_verify($password, $user['password_hash'])) {
        return ['success' => false, 'error' => 'Грешна парола'];
    }
    $_SESSION['user_id'] = $user['id'];
    $_SESSION['logged_in'] = true;
    return ['success' => true];
}

8.5 Файл: js/graph.js

Цел: Граф структура и алгоритъм на Dijkstra

Код (фрагмент 11 - Dijkstra алгоритъм):
dijkstra(startId, endId) {
    const distances = {};
    const previous = {};
    
    for (let nodeId in this.nodes) {
        distances[nodeId] = Infinity;
        previous[nodeId] = null;
    }
    distances[startId] = 0;
    
    while (queue.length > 0) {
        queue.sort((a, b) => a.distance - b.distance);
        const current = queue.shift();
        
        const neighbors = this.adjacencyList[current.id];
        for (let neighborId in neighbors) {
            const newDistance = distances[current.id] + neighbors[neighborId];
            if (newDistance < distances[neighborId]) {
                distances[neighborId] = newDistance;
                previous[neighborId] = current.id;
            }
        }
    }
    return { path, distance: distances[endId] };
}

8.6 Файл: sql/database.sql

Цел: Създаване на таблици и примерни данни

Код (фрагмент 12 - CREATE TABLE users):
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

Код (фрагмент 13 - CREATE TABLE nodes):
CREATE TABLE nodes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    lat DECIMAL(10, 7) NOT NULL,
    lng DECIMAL(10, 7) NOT NULL,
    floor INT DEFAULT 1,
    building VARCHAR(100)
);

Код (фрагмент 14 - CREATE TABLE edges):
CREATE TABLE edges (
    id INT AUTO_INCREMENT PRIMARY KEY,
    node_from INT NOT NULL,
    node_to INT NOT NULL,
    weight INT NOT NULL DEFAULT 1,
    FOREIGN KEY (node_from) REFERENCES nodes(id) ON DELETE CASCADE,
    FOREIGN KEY (node_to) REFERENCES nodes(id) ON DELETE CASCADE
);

================================================================================
9. ПРИНОСИ, ОГРАНИЧЕНИЯ И ВЪЗМОЖНОСТИ ЗА РАЗШИРЕНИЕ
================================================================================

9.1 Текущо състояние:

Реализирана е работеща система с трислойна архитектура:
- Презентационен слой: HTML, CSS, JavaScript, Leaflet
- Бизнес логика: PHP с PDO
- База данни: MySQL

9.2 Ограничения:

- Примерни координати (не реални данни за конкретен кампус)
- Няма административен панел за управление
- Няма роли с различни права (admin/user)
- Само един вид транспорт (пешеходно)
- Няма етажни планове на сгради

9.3 Възможности за разширение:

- Административен панел за CRUD операции през интерфейса
- Система с роли (администратор, потребител, гост)
- Добавяне на реални координати за конкретен кампус
- Различни видове транспорт с различни тежести
- Интеграция с разписания на градски транспорт
- Етажни планове на сгради
- Мобилно приложение

================================================================================
10. ИЗПОЛЗВАНЕ НА AI
================================================================================

AI инструмент: GitHub Copilot (Claude)

Използвани промптове:

Промпт 1: "Създай скеле на проект за визуализация на кампус с OpenStreetMap, 
граф структура и Dijkstra алгоритъм. Използвай HTML, CSS, JavaScript."

Промпт 2: "Добави PHP backend с MySQL база данни. Трябва да има таблици за 
зали (nodes), връзки (edges) и потребители (users). Добави CRUD операции."

Промпт 3: "Направи форми за регистрация и вход на потребители."

Резултат: Генериране на работеща трислойна архитектура с обяснителни коментари.

================================================================================
11. КАКВО НАУЧИХ
================================================================================

Студент 1:
...

Студент 2:
...

================================================================================
12. DEVOPS - ПОДКАРВАНЕ НА ПРОЕКТА
================================================================================

12.1 Линк към проекта в GitLab на ФМИ:
https://gitlab.hss.fmi.uni-sofia.bg/...

12.2 Линк към разгърнат проект във ФМИ:
https://w25-...-campus-navigator.hss.fmi.uni-sofia.bg

12.3 Инструкции за подкарване:

За локална инсталация (XAMPP):
1. Копирайте папката в C:\xampp\htdocs\ProjectWeb
2. Стартирайте Apache и MySQL от XAMPP Control Panel
3. Отворете phpMyAdmin (http://localhost/phpmyadmin)
4. Импортирайте sql/database.sql
5. Отворете http://localhost/ProjectWeb

За Docker (ако се използва):
- Необходими са Apache + PHP + MySQL контейнери
- SQL файл: sql/database.sql
- Конфигурация: php/config.php

================================================================================
13. ИЗПОЛЗВАНИ ИЗТОЧНИЦИ
================================================================================

[1] Leaflet - Open-Source JavaScript Library for Interactive Maps
    URL: https://leafletjs.com/
    Дата на посещение: 2026-01-08

[2] OpenStreetMap
    URL: https://www.openstreetmap.org/
    Дата на посещение: 2026-01-08

[3] PHP PDO Documentation
    URL: https://www.php.net/manual/en/book.pdo.php
    Дата на посещение: 2026-01-10

[4] Dijkstra's Algorithm - Wikipedia
    URL: https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm
    Дата на посещение: 2026-01-08

[5] XAMPP - Apache Friends
    URL: https://www.apachefriends.org/
    Дата на посещение: 2026-01-10

[6] MDN Web Docs - JavaScript
    URL: https://developer.mozilla.org/en-US/docs/Web/JavaScript
    Дата на посещение: 2026-01-08

================================================================================
Предал (подпис): ........................................
                 /фн, имена, спец., група/

Приел (подпис): ........................................
                /доц. д-р Милен Петров/
================================================================================
